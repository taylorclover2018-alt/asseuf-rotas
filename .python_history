def coletar_diarias(rota_nome):
    print(f"\n=== Cadastro de diárias da rota {rota_nome} ===")
    veiculos = {}
    while True:
        tipo = input("Tipo de veículo (ex: ônibus, micro, van) ou ENTER para finalizar: ").strip()
        if tipo == "":
            break
        valor = float(input(f"Valor da diária do veículo '{tipo}': R$ "))
        dias = int(input(f"Quantas diárias o veículo '{tipo}' rodou na rota {rota_nome} neste mês? "))
        veiculos[tipo] = {"valor": valor, "dias": dias}
    return veiculos


def calcular_bruto(veiculos):
    return sum(v["valor"] * v["dias"] for v in veiculos.values())


def coletar_alunos(rota_nome):
    print(f"\n=== Cadastro de alunos da rota {rota_nome} ===")
    integrais = int(input("Quantidade de alunos integrais: "))
    descontos = {}
    while True:
        tipo = input("Percentual de desconto (ex: 50, 70) ou ENTER para finalizar: ").strip()
        if tipo == "":
            break
        qtd = int(input(f"Quantidade de alunos com {tipo}% de desconto: "))
        descontos[int(tipo)] = qtd
    return integrais, descontos


def alunos_equivalentes(integrais, descontos):
    total = integrais
    for pct, qtd in descontos.items():
        fator = (100 - pct) / 100
        total += qtd * fator
    return total


def dividir_auxilio(aux_total, pass_7l, pass_cur, d7, dC):
    # 10% das passagens reduz o auxílio disponível
    desconto_passagens = 0.10 * (pass_7l + pass_cur)
    aux_disponivel = aux_total - desconto_passagens

    # Se diárias iguais → divisão proporcional normal
    if d7 == dC:
        total = d7 + dC
        return (
            aux_disponivel * (d7 / total),
            aux_disponivel * (dC / total)
        )

    # Se 7 Lagoas rodou mais
    if d7 > dC:
        excedente = d7 - dC
        base = min(d7, dC)

        total_base = base * 2 + excedente
        valor_diaria = aux_disponivel / total_base

        aux_7l = base * valor_diaria + excedente * (valor_diaria * 0.70)
        aux_cur = base * valor_diaria + excedente * (valor_diaria * 0.30)

        return aux_7l, aux_cur

    # Se Curvelo rodou mais
    excedente = dC - d7
    base = min(d7, dC)

    total_base = base * 2 + excedente
    valor_diaria = aux_disponivel / total_base

    aux_7l = base * valor_diaria + excedente * (valor_diaria * 0.30)
    aux_cur = base * valor_diaria + excedente * (valor_diaria * 0.70)

    return aux_7l, aux_cur


def relatorio(rota_nome, bruto, aux_ideal, passagens, alunos_eq, integrais, descontos):
    print(f"\n\n===== RELATÓRIO DA ROTA {rota_nome} =====")
    print(f"Bruto do mês: R$ {bruto:.2f}")
    print(f"Auxílio ideal do mês: R$ {aux_ideal:.2f}")
    print(f"Passagens arrecadadas: R$ {passagens:.2f}")

    liquido = bruto - aux_ideal - passagens
    print(f"Valor líquido a dividir entre os alunos: R$ {liquido:.2f}")

    mensalidade_integral = liquido / alunos_eq
    print(f"\nMensalidade aluno integral: R$ {mensalidade_integral:.2f}")

    print("\nMensalidade alunos com desconto:")
    for pct, qtd in descontos.items():
        fator = (100 - pct) / 100
        valor = mensalidade_integral * fator
        print(f"  {qtd} aluno(s) com {pct}% → R$ {valor:.2f}")

    return mensalidade_integral


# ============================
# PROGRAMA PRINCIPAL (MENSAL)
# ============================

print("=== SISTEMA MENSAL DE CÁLCULO DE ROTAS ===")

# 1) Coleta de diárias
veic_7l = coletar_diarias("7 Lagoas")
veic_cur = coletar_diarias("Curvelo")

# 2) Cálculo de bruto
bruto_7l = calcular_bruto(veic_7l)
bruto_cur = calcular_bruto(veic_cur)

# 3) Diárias totais
diarias_7l = sum(v["dias"] for v in veic_7l.values())
diarias_cur = sum(v["dias"] for v in veic_cur.values())

# 4) Auxílio total do mês
aux_total = float(input("\nValor TOTAL de auxílio do mês para dividir entre as rotas: R$ "))

# 5) Passagens
pass_7l = float(input("\nPassagens arrecadadas em 7 Lagoas neste mês: R$ "))
pass_cur = float(input("Passagens arrecadadas em Curvelo neste mês: R$ "))

# 6) Auxílio ideal com regras novas
aux_ideal_7l, aux_ideal_cur = dividir_auxilio(aux_total, pass_7l, pass_cur, diarias_7l, diarias_cur)

# 7) Alunos
int_7l, desc_7l = coletar_alunos("7 Lagoas")
int_cur, desc_cur = coletar_alunos("Curvelo")

# 8) Alunos equivalentes
al_eq_7l = alunos_equivalentes(int_7l, desc_7l)
al_eq_cur = alunos_equivalentes(int_cur, desc_cur)

# 9) Relatórios
mens_7l = relatorio("7 Lagoas", bruto_7l, aux_ideal_7l, pass_7l, al_eq_7l, int_7l, desc_7l)
mens_cur = relatorio("Curvelo", bruto_cur, aux_ideal_cur, pass_cur, al_eq_cur, int_cur, desc_cur)

# 10) Comparação final
print("\n\n===== COMPARAÇÃO ENTRE AS ROTAS =====")
print(f"7 Lagoas rodou {diarias_7l} diárias")
print(f"Curvelo rodou {diarias_cur} diárias")

dif_diarias = ((diarias_7l - diarias_cur) / diarias_cur) * 100
print(f"Diferença percentual de diárias: {dif_diarias:.2f}%")

dif_bruto = ((bruto_7l - bruto_cur) / bruto_cur) * 100
print(f"Diferença percentual de custo bruto: {dif_bruto:.2f}%")

dif_mens = ((mens_7l - mens_cur) / mens_cur) * 100
print(f"Diferença percentual entre mensalidades integrais: {dif_mens:.2f}%")

micro
905
12
van
1000
5
doblo
532
2
van
500
4
onibus
691
13
12000
360
820
42
50
1
22
50
9
